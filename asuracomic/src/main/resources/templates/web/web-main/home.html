<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRANG CHỦ</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="/css/web/web-main/home.css">
</head>
<body>
<!-- fragments cho header -->
<th:block th:replace="~{web/fragments/header::header}"></th:block>

<!-- Main Body Section -->
<main>
    <div class="main-container">
        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <!-- Hot Comics Carousel -->
                <div class="carousel-container">
                    <div id="carouselSlides">
                        <th:block th:each="comic : ${hotComics}">
                            <div class="carousel-slide" th:attr="data-id=${comic.id}">
                                <div class="comic-info">
                                    <div class="rating">
                                        <span class="star">⭐</span>
                                        <span th:text="${comic.averageRating}"></span>
                                    </div>
                                    <h1><a th:href="@{/asura/comic(id=${comic.id})}" class="card-title" th:text="${comic.title}"></a></h1>
                                    <h3 th:text="${comic.type}">MANHWA</h3>
                                    <p th:text="${comic.genres}">Genres</p>
                                    <h4>SUMMARY</h4>
                                    <p th:text="${comic.summary}">Summary here...</p>
                                    <p><strong>Status:</strong> <span th:text="${comic.status}"></span></p>
                                    <p><strong>Author:</strong> <span th:text="${comic.author}">Author Name</span></p>
                                </div>
                                <div class="comic-cover">
                                    <img  th:src="${comic.coverImage}" th:alt="${comic.title}" />
                                </div>
                            </div>
                        </th:block>
                    </div>
                    <div class="carousel-dots" id="carouselDots"></div>
                </div>


                <!-- Popular Today Section -->
                <section class="popular-today">
                    <div class="container">
                        <h2 class="mb-4">Popular Views</h2>
                        <div class="comic-container">
                            <div th:each="comic : ${popularToday}" class="card">
                                <img th:src="@{${comic.coverImage}}" class="card-img-top" th:alt="${comic.title}" />
                                <span class="comic-type" th:text="${comic.type}"></span>
                                <div class="card-body">
                                    <a th:href="@{/asura/comic(id=${comic.id})}" class="card-title" th:text="${comic.title}"></a>
                                    <p class="card-text">
                                        Chapter
                                        <span th:text="${#lists.isEmpty(comic.chapters) ? '??' : comic.chapters[comic.chapters.size() - 1].chapterNumber}"></span>
                                    </p>
                                    <p class="card-rating">
                        <span class="star-rating">
                            <i class="fas fa-star" th:each="i : ${#numbers.sequence(1, comic.averageRating.intValue())}"></i>
                        </span>
                                        <span th:text="${comic.averageRating}"></span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>



                <!-- Latest Updates Section -->
                <section class="latest-updates">
                    <div class="container">
                        <h2 class="mb-4">
                            <span class="new-label">NEW</span> Latest Updates
                        </h2>
                        <div class="comic-grid" id="comicGrid">
                            <div class="comic-item" data-id="1">
                                <img src="https://gg.asuracomic.net/storage/media/261340/conversions/01JGBYSXQG2X42HGAHQ33MDHCQ-thumb-small.webp" class="comic-image" alt="Extra of a Crazy World With a Very Long Title That Should Be Truncated">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Extra of a Crazy World With a Very Long Title That Should Be Truncated">Extra of a Crazy World With a Very Long Title That Should Be Truncated</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="22" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 22</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="21" data-created-at="2025-04-15 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 21</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="2">
                                <img src="https://gg.asuracomic.net/storage/media/279987/conversions/01JP56DAW10PQ08Y5XJZAA5V9W-thumb-small.webp" class="comic-image" alt="Wind Breaker">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Wind Breaker">Wind Breaker</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="544" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 544</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="543" data-created-at="2025-04-13 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 543</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="3">
                                <img src="https://gg.asuracomic.net/storage/media/257968/conversions/01JF6DD6P4PAVNG43QP7XN9676-thumb-small.webp" class="comic-image" alt="The Crazy Genius Composer Returns With a Long Title Here">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="The Crazy Genius Composer Returns With a Long Title Here">The Crazy Genius Composer Returns With a Long Title Here</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="62" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 62</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="61" data-created-at="2025-04-08 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 61</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="4">
                                <img src="https://gg.asuracomic.net/storage/media/266867/conversions/01JJGM5K45NBQ2156PKB12KXEN-thumb-small.webp" class="comic-image" alt="Dao of the Bizarre Immortal">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Dao of the Bizarre Immortal">Dao of the Bizarre Immortal</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="32" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 32</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="31" data-created-at="2025-04-16 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 31</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="5">
                                <img src="https://gg.asuracomic.net/storage/media/263608/conversions/01JH5TBN2T87D48PVY7BD1TTNH-thumb-small.webp" class="comic-image" alt="Spooky Yokai">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Spooky Yokai">Spooky Yokai</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="10" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 10</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="9" data-created-at="2025-04-11 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 9</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="6">
                                <img src="https://gg.asuracomic.net/storage/media/257722/conversions/01JF3DFZHDVHCNHVKXCGTD16KM-thumb-small.webp" class="comic-image" alt="Emperor of Solo Play With a Very Long Title That Needs to Be Shortened">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Emperor of Solo Play With a Very Long Title That Needs to Be Shortened">Emperor of Solo Play With a Very Long Title That Needs to Be Shortened</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="7" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 7</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="6" data-created-at="2025-04-22 09:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 6</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="7">
                                <img src="https://gg.asuracomic.net/storage/media/261340/conversions/01JGBYSXQG2X42HGAHQ33MDHCQ-thumb-small.webp" class="comic-image" alt="Mercenary Enrollment">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Mercenary Enrollment">Mercenary Enrollment</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="234" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 234</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="233" data-created-at="2025-04-12 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 233</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="8">
                                <img src="https://gg.asuracomic.net/storage/media/279987/conversions/01JP56DAW10PQ08Y5XJZAA5V9W-thumb-small.webp" class="comic-image" alt="The Legendary Hero is an Academy Honors Student">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="The Legendary Hero is an Academy Honors Student">The Legendary Hero is an Academy Honors Student</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="36" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 36</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="35" data-created-at="2025-04-12 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 35</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="9">
                                <img src="https://gg.asuracomic.net/storage/media/79/1be5e62f.webp" class="comic-image" alt="Nano Machine">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Nano Machine">Nano Machine</a>
                                    <div class="comic-meta">
                                        <span class="rating">9.9 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="257" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 257</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="256" data-created-at="2025-04-10 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 256</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="10">
                                <img src="https://gg.asuracomic.net/storage/media/155/conversions/e43c72fb-thumb-small.webp" class="comic-image" alt="Eternally Regressing Knight">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Eternally Regressing Knight">Eternally Regressing Knight</a>
                                    <div class="comic-meta">
                                        <span class="rating">9.9 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="54" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 54</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="53" data-created-at="2025-04-09 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 53</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="11">
                                <img src="https://gg.asuracomic.net/storage/media/267698/conversions/01JJST2HQ54CXEV2YQN2621FTB-thumb-small.webp" class="comic-image" alt="Terminally-Ill Genius Dark Knight">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Terminally-Ill Genius Dark Knight">Terminally-Ill Genius Dark Knight</a>
                                    <div class="comic-meta">
                                        <span class="rating">9.7 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="91" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 91</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="90" data-created-at="2025-04-07 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 90</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="comic-item" data-id="12">
                                <img src="https://gg.asuracomic.net/storage/media/243337/conversions/01J9AHYZQ90WM6831SZ98MGN55-thumb-small.webp" class="comic-image" alt="Pick Me Up, Infinite Gacha">
                                <div class="comic-info">
                                    <a href="#" class="comic-title" title="Pick Me Up, Infinite Gacha">Pick Me Up, Infinite Gacha</a>
                                    <div class="comic-meta">
                                        <span class="rating">10 <i class="fas fa-star"></i></span>
                                        <span class="status">ONGOING</span>
                                    </div>
                                    <ul class="chapter-list">
                                        <li class="chapter-item" data-chapter="145" data-created-at="2025-04-22 10:00:00" data-is-free="false">
                                            <span class="chapter-number">Chapter 145</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                        <li class="chapter-item" data-chapter="144" data-created-at="2025-04-05 10:00:00" data-is-free="true">
                                            <span class="chapter-number">Chapter 144</span>
                                            <span class="chapter-time"></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="pagination" id="pagination"></div>
                    </div>
                </section>
            </div>
            <!-- HTML: Sidebar (phần truyện phổ biến) -->
            <th:block th:replace="~{web/fragments/popular::.col-lg-4}"></th:block>

        </div>
    </div>
</main>

<!-- Footer Section -->
<th:block th:replace="~{web/fragments/footer::footer}"></th:block>

<!-- JavaScript for Hot Comics Carousel -->
<script>
    const slidesContainer = document.getElementById("carouselSlides");
    const dotsContainer = document.getElementById("carouselDots");
    const slides = slidesContainer.querySelectorAll(".carousel-slide");

    slides.forEach((_, index) => {
        const dot = document.createElement("span");
        dot.className = `dot ${index === 0 ? "active" : ""}`;
        dot.addEventListener("click", () => showSlide(index));
        dotsContainer.appendChild(dot);
    });

    let currentIndex = 0;

    function showSlide(index) {
        currentIndex = index;
        const slides = document.querySelectorAll(".carousel-slide");
        const dots = document.querySelectorAll(".dot");

        slides.forEach((slide, i) => {
            slide.classList.toggle("active", i === index);
        });

        dots.forEach((dot, i) => {
            dot.classList.toggle("active", i === index);
        });
    }

    showSlide(0);

    setInterval(() => {
        currentIndex = (currentIndex + 1) % slides.length;
        showSlide(currentIndex);
    }, 5000);
</script>

<!-- JavaScript for Latest Updates -->
<script>
    const comicItems = document.querySelectorAll("#comicGrid .comic-item");
    const itemsPerPage = 10;
    const totalPages = Math.ceil(comicItems.length / itemsPerPage);
    let currentPage = 1;

    function getTimeStatus(createdAt) {
        const createdDate = new Date(createdAt);
        const now = new Date();
        const diffTime = Math.abs(now - createdDate);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        return diffDays <= 1 ? "New" : `${diffDays} days`;
    }

    comicItems.forEach(item => {
        const chapterItems = item.querySelectorAll(".chapter-item");
        chapterItems.forEach(chapter => {
            const createdAt = chapter.getAttribute("data-created-at");
            const isFree = chapter.getAttribute("data-is-free") === "true";
            const timeStatus = getTimeStatus(createdAt);
            const timeElement = chapter.querySelector(".chapter-time");
            timeElement.innerHTML = `
                ${timeStatus === "New" ? `<span class="new-tag">New</span>` : timeStatus}
                ${isFree ? "" : '<i class="fas fa-lock lock-icon"></i>'}
            `;
        });
    });

    function displayComics(page) {
        const comicGrid = document.getElementById("comicGrid");
        comicItems.forEach((item, index) => {
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            item.style.display = (index >= start && index < end) ? "flex" : "none";
        });
        updatePagination();
    }

    function updatePagination() {
        const pagination = document.getElementById("pagination");
        pagination.innerHTML = "";

        const prevBtn = document.createElement("button");
        prevBtn.className = "prev-btn";
        prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i> Previous';
        prevBtn.disabled = currentPage === 1;
        prevBtn.classList.toggle("disabled", currentPage === 1);
        prevBtn.addEventListener("click", () => {
            if (currentPage > 1) {
                currentPage--;
                displayComics(currentPage);
            }
        });
        pagination.appendChild(prevBtn);

        const nextBtn = document.createElement("button");
        nextBtn.className = "next-btn";
        nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
        nextBtn.disabled = currentPage === totalPages;
        nextBtn.classList.toggle("disabled", currentPage === totalPages);
        nextBtn.addEventListener("click", () => {
            if (currentPage < totalPages) {
                currentPage++;
                displayComics(currentPage);
            }
        });
        pagination.appendChild(nextBtn);
    }

    displayComics(currentPage);
</script>

<!-- JavaScript for Popular Section Tabs -->
<script>
    const tabs = document.querySelectorAll(".popular-section .tab");
    const comicList = document.getElementById("comicList");

    tabs.forEach(tab => {
        tab.addEventListener("click", () => {
            tabs.forEach(t => t.classList.remove("active"));
            tab.classList.add("active");

            const tabType = tab.getAttribute("data-tab");
            console.log(`Switched to ${tabType} tab`);
        });
    });
</script>

<script>
    // Tab switching functionality
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            // Remove active class from all tabs and lists
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.comic-list').forEach(list => list.classList.remove('active'));

            // Add active class to the clicked tab
            tab.classList.add('active');

            // Show the corresponding list
            const tabName = tab.getAttribute('data-tab');
            document.getElementById(`${tabName}List`).classList.add('active');
        });
    });
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>