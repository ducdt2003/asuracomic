<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AdminLTE 3 | Chỉnh sửa phim</title>

    &lt;!&ndash; Google Font &ndash;&gt;
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback" />
    &lt;!&ndash; Font Awesome &ndash;&gt;
    <link rel="stylesheet" href="/css/admin-assets/plugins/fontawesome-free/css/all.min.css" />
    &lt;!&ndash; AdminLTE &ndash;&gt;
    <link rel="stylesheet" href="/css/admin-assets/dist/css/adminlte.min.css" />
    &lt;!&ndash; Select2 &ndash;&gt;
    <link rel="stylesheet" href="/css/admin-assets/plugins/select2/css/select2.min.css" />
</head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">

    &lt;!&ndash; Navbar &ndash;&gt;
    <nav class="main-header navbar navbar-expand navbar-white navbar-light">
        &lt;!&ndash; Left navbar links &ndash;&gt;
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
            </li>
        </ul>

        &lt;!&ndash; Right navbar links &ndash;&gt;
        <ul class="navbar-nav ml-auto">
            &lt;!&ndash; User Dropdown &ndash;&gt;
            <li class="nav-item dropdown">
                <a class="nav-link py-0 d-flex align-items-center" data-toggle="dropdown" href="#">
                    <div class="user-panel">
                        <div class="image">
                            <img src="../../dist/img/user2-160x160.jpg" class="img-circle border" alt="User Image">
                        </div>
                    </div>
                </a>
                <div class="dropdown-menu dropdown-menu-sm dropdown-menu-right">
                    <a href="#" class="dropdown-item">
                        <span class="text-muted">Trang chủ</span>
                    </a>
                    <a href="#" class="dropdown-item">
                        <span class="text-muted">Đăng xuất</span>
                    </a>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-widget="fullscreen" href="#" role="button">
                    <i class="fas fa-expand-arrows-alt"></i>
                </a>
            </li>
        </ul>
    </nav>

    &lt;!&ndash; Sidebar &ndash;&gt;
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
        &lt;!&ndash; Brand Logo &ndash;&gt;
        <a href="./index.html" class="brand-link">
            <img src="dist/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3"
                 style="opacity: 0.8" />
            <span class="brand-text font-weight-light">Admin</span>
        </a>

        &lt;!&ndash; Sidebar Menu &ndash;&gt;
        <div class="sidebar">
            <nav class="mt-2">
                <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                    data-accordion="false">
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="nav-icon fas fa-chart-pie"></i>
                            <p>
                                Quản lý bài viết
                                <i class="right fas fa-angle-left"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item">
                                <a href="./blog-index.html" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Tất cả bài viết</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="./blog-yourself.html" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Bài viết của tôi</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="./blog-create.html" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Tạo bài viết</p>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="nav-icon fas fa-tree"></i>
                            <p>
                                Quản lý user
                                <i class="fas fa-angle-left right"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item">
                                <a href="pages/UI/general.html" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Danh sách user</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="pages/UI/icons.html" class="nav-link">
                                    <i class="far fa-circle nav-icon"></i>
                                    <p>Tạo user</p>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>
    </aside>

    &lt;!&ndash; Content Wrapper &ndash;&gt;
    <div class="content-wrapper">
        <div class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-12">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/admin">Dashboard</a></li>
                            <li class="breadcrumb-item"><a href="/admin/movies">Phim</a></li>
                            <li class="breadcrumb-item active">Chỉnh sửa phim</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        &lt;!&ndash; Main content &ndash;&gt;
        <section class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Chỉnh sửa phim</h3>
                            </div>
                            <div class="card-body">
                                <form action="/admin/movies/edit/1" method="post">
                                    <div class="row">
                                        <div class="col-md-8">
                                            <div class="form-group">
                                                <label>Tên phim</label>
                                                <input type="text" class="form-control" name="name" value="Avengers: Endgame" required />
                                            </div>
                                            <div class="form-group">
                                                <label>Mô tả</label>
                                                <textarea class="form-control" rows="5" name="description">Trận chiến cuối cùng chống lại Thanos.</textarea>
                                            </div>
                                            <div class="form-group">
                                                <label>Trailer (URL)</label>
                                                <input type="text" class="form-control" name="trailerUrl" value="https://youtube.com/trailer" required />
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label>Trạng thái</label>
                                                <select class="form-control" name="status">
                                                    <option value="true" selected>Công khai</option>
                                                    <option value="false">Nháp</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Loại phim</label>
                                                <select class="form-control" name="type">
                                                    <option selected>Phim lẻ</option>
                                                    <option>Phim bộ</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Năm phát hành</label>
                                                <input type="number" class="form-control" name="releaseYear" value="2019" />
                                            </div>
                                            <div class="form-group">
                                                <label>Quốc gia</label>
                                                <select class="form-control" name="countryId">
                                                    <option value="">Chọn quốc gia</option>
                                                    <option value="1" selected>Mỹ</option>
                                                    <option value="2">Nhật Bản</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Thể loại</label>
                                                <select class="select2 form-control" multiple name="genreIds">
                                                    <option value="1" selected>Hành động</option>
                                                    <option value="2" selected>Khoa học viễn tưởng</option>
                                                    <option value="3">Hài</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Diễn viên</label>
                                                <select class="select2 form-control" multiple name="actorIds">
                                                    <option value="1" selected>Robert Downey Jr.</option>
                                                    <option value="2" selected>Chris Evans</option>
                                                    <option value="3">Scarlett Johansson</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Đạo diễn</label>
                                                <select class="select2 form-control" multiple name="directorIds">
                                                    <option value="1" selected>Anthony Russo</option>
                                                    <option value="2" selected>Joe Russo</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                                        <a href="/admin/movies" class="btn btn-default">Hủy</a>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

&lt;!&ndash; Scripts &ndash;&gt;
<script src="/css/admin-assets/plugins/jquery/jquery.min.js"></script>
<script src="/css/admin-assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/css/admin-assets/plugins/select2/js/select2.full.min.js"></script>
<script src="/css/admin-assets/dist/js/adminlte.min.js"></script>
<script>
    $(document).ready(function () {
        $('.select2').select2();
    });
</script>
</body>
</html>
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AdminLTE 3 | Chỉnh sửa truyện</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="/css/admin-assets/plugins/fontawesome-free/css/all.min.css" />
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" />
    <!-- Theme style -->
    <link rel="stylesheet" href="/css/admin-assets/dist/css/adminlte.min.css" />
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="/css/admin-assets/plugins/overlayScrollbars/css/OverlayScrollbars.min.css" />
    <!-- EasyMDE for description editing -->
    <link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/highlight.js/latest/styles/github.min.css" />
    <!-- Select2 for multi-select -->
    <link rel="stylesheet" href="/css/admin-assets/plugins/select2/css/select2.min.css" />
    <link rel="stylesheet" href="/css/admin-assets/dist/css/style.css">
</head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">
    <!-- Navbar -->
    <th:block th:replace="~{admin-templ/fragments/navbar :: navbar}"></th:block>
    <!-- Sidebar -->
    <th:block th:replace="~{admin-templ/fragments/sidebar-content :: sidebar-content}"></th:block>
    <!-- Content Wrapper -->
    <div class="content-wrapper">
        <div class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-12">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/asura/admin/comic/content/detail">Comic</a></li>
                            <li class="breadcrumb-item active" id="comic-title-breadcrumb">Chỉnh sửa truyện</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main content -->
        <section class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Chỉnh sửa truyện</h3>
                            </div>
                            <div class="card-body">
                                <!-- SUCCESS -->
                                <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show">
                                    <i class="fas fa-check-circle"></i>
                                    <span th:text="${successMessage}"></span>
                                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                                </div>

                                <!-- ERROR -->
                                <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show">
                                    <i class="fas fa-times-circle"></i>
                                    <span th:text="${errorMessage}"></span>
                                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                                </div>

                                <form id="comic-form" th:action="@{/asura/admin/comic/content/edit/{slug}(slug=${comic.slug})}" method="post">
                                    <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
                                    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
                                    <div class="row">
                                        <div class="col-md-8">
                                            <div class="form-group">
                                                <label>Tiêu đề <span class="text-danger">*</span></label>
                                                <input type="text" class="form-control" id="title" name="title"
                                                       th:value="${comic.title}" required />
                                            </div>
                                            <div class="form-group">
                                                <label>Slug <span class="text-danger">*</span></label>
                                                <input type="text" class="form-control" id="slug" name="slug"
                                                       th:value="${comic.slug}" required />
                                            </div>
                                            <div class="form-group">
                                                <label>Mô tả</label>
                                                <textarea id="description" name="description" th:text="${comic.description}"></textarea>
                                            </div>
                                            <div class="form-group">
                                                <label>Serialization</label>
                                                <input type="text" class="form-control" id="serialization" name="serialization"
                                                       th:value="${comic.serialization}" />
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label>Trạng thái</label>
                                                <select id="status" name="status" class="form-control">
                                                    <option value="ONGOING" th:selected="${comic.status == 'ONGOING'}">Đang tiến hành</option>
                                                    <option value="COMPLETED" th:selected="${comic.status == 'COMPLETED'}">Hoàn thành</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Loại truyện</label>
                                                <select id="type" name="type" class="form-control">
                                                    <option value="MANHWA" th:selected="${comic.type == 'MANHWA'}">Manhwa</option>
                                                    <option value="MANGA" th:selected="${comic.type == 'MANGA'}">Manga</option>
                                                    <option value="MANHUA" th:selected="${comic.type == 'MANHUA'}">Manhua</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Thể loại</label>
                                                <select class="select2 form-control" multiple id="genres" name="genreIds">
                                                    <option th:each="genre : ${allGenres}"
                                                            th:value="${genre.id}"
                                                            th:text="${genre.name}"
                                                            th:selected="${#lists.contains(selectedGenreIds, genre.id)}"></option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Tác giả</label>
                                                <select class="select2 form-control" multiple id="authors" name="authorIds">
                                                    <option th:each="author : ${allAuthors}"
                                                            th:value="${author.id}"
                                                            th:text="${author.name}"
                                                            th:selected="${#lists.contains(selectedAuthorIds, author.id)}"></option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Họa sĩ</label>
                                                <select class="select2 form-control" multiple id="artists" name="artistIds">
                                                    <option th:each="artist : ${allArtists}"
                                                            th:value="${artist.id}"
                                                            th:text="${artist.name}"
                                                            th:selected="${#lists.contains(selectedArtistIds, artist.id)}"></option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>Hình bìa</label>
                                                <div class="thumbnail-preview-container mb-3">
                                                    <img th:src="${comic.coverImage}" alt="Hình bìa" id="coverImage" style="max-width: 100%; height: auto;" />
                                                </div>
                                                <button type="button" class="btn btn-info btn-flat" data-toggle="modal" data-target="#modal-xl">
                                                    Chọn hình ảnh
                                                </button>
                                                <input type="hidden" name="coverImage" id="coverImageInput" th:value="${comic.coverImage}">
                                            </div>
                                            <div class="form-group">
                                                <label>Trạng thái xuất bản</label>
                                                <select id="isPublished" name="isPublished" class="form-control">
                                                    <option value="true" th:selected="${comic.isPublished == true}">Công khai</option>
                                                    <option value="false" th:selected="${comic.isPublished == false}">Ẩn</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Chapters Section -->
                                    <div class="row">
                                        <div class="col-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h3 class="card-title">Danh sách chương</h3>
                                                    <div class="card-tools">
                                                        <a th:href="@{/asura/admin/comic/content/chapter/update/{id}(id=${comic.id})}"
                                                           class="btn btn-sm btn-primary">
                                                            Thêm chương
                                                        </a>
                                                    </div>

                                                </div>
                                                <div class="card-body">
                                                    <table class="table table-bordered">
                                                        <thead>
                                                        <tr>
                                                            <th>Số chương</th>
                                                            <th>Tiêu đề</th>
                                                            <th>Lượt xem</th>
                                                            <th>Miễn phí</th>
                                                            <th>Giá coin</th>
                                                            <th>Trạng thái</th>
                                                            <th>Hành động</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        <tr th:each="chapter : ${chapterPage.content}">
                                                            <td th:text="${chapter.chapterNumber}"></td>
                                                            <td th:text="${chapter.title}"></td>
                                                            <td th:text="${chapter.viewCount}"></td>
                                                            <td th:text="${chapter.isFree} ? 'Có' : 'Không'"></td>
                                                            <td th:text="${chapter.coinPrice}"></td>
                                                            <td th:text="${chapter.isPublished} ? 'Công khai' : 'Ẩn'"></td>
                                                            <td>
                                                                <a th:href="@{/asura/admin/comic/content/chapter/edit/{chapterId}(chapterId=${chapter.id})}"
                                                                   class="btn btn-sm btn-warning">Sửa</a>
                                                                <button class="btn btn-sm btn-danger" th:onclick="'deleteChapter(' + ${chapter.id} + ')'">Xóa</button>
                                                            </td>
                                                        </tr>
                                                        <tr th:if="${#lists.isEmpty(chapterPage.content)}">
                                                            <td colspan="7" class="text-center">Chưa có chương nào</td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                    <div th:if="${chapterPage.totalPages > 1}">
                                                        <ul class="pagination"
                                                            style="display: flex; justify-content: center; align-items: center; margin-top: 20px;">

                                                            <li class="page-item" th:classappend="${chapterPage.isFirst()} ? 'disabled'">
                                                                <a class="page-link"
                                                                   style="color: #28a745; border: 1px solid #dee2e6; padding: 6px 12px; text-decoration: none; border-radius: 5px; background-color: #f8f9fa; transition: color 0.3s, background-color 0.3s;"
                                                                   th:href="@{/asura/admin/comic/content/{slug}(slug=${comic.slug}, page=${chapterPage.number - 1}, size=${chapterPage.size})}"
                                                                   th:style="${chapterPage.isFirst()} ? 'color: #6c757d; background-color: #e9ecef; cursor: not-allowed;' : 'color: #28a745;'"
                                                                   onmouseover="this.style.backgroundColor='#e9ecef'; this.style.color='#218838';"
                                                                   onmouseout="this.style.backgroundColor='#f8f9fa'; this.style.color='#28a745';">«</a>
                                                            </li>

                                                            <li class="page-item"
                                                                th:each="i : ${#numbers.sequence(0, chapterPage.totalPages - 1)}"
                                                                th:classappend="${i == chapterPage.number} ? 'active'"
                                                                style="margin: 0 5px;">
                                                                <a class="page-link"
                                                                   style="color: #0d6efd; border: 1px solid #dee2e6; padding: 6px 12px; text-decoration: none; border-radius: 5px; background-color: #f8f9fa; transition: color 0.3s, background-color 0.3s;"
                                                                   th:href="@{/asura/admin/comic/content/{slug}(slug=${comic.slug}, page=${i}, size=${chapterPage.size})}"
                                                                   th:text="${i + 1}"
                                                                   th:style="${i == chapterPage.number} ? 'color: #fff; background-color: #0d6efd; border-color: #0d6efd;' : ''"
                                                                   onmouseover="if (!this.parentElement.classList.contains('active')) { this.style.backgroundColor='#e9ecef'; this.style.color='#0b5ed7'; }"
                                                                   onmouseout="if (!this.parentElement.classList.contains('active')) { this.style.backgroundColor='#f8f9fa'; this.style.color='#0d6efd'; }"></a>
                                                            </li>

                                                            <li class="page-item" th:classappend="${chapterPage.isLast()} ? 'disabled'">
                                                                <a class="page-link"
                                                                   style="color: #28a745; border: 1px solid #dee2e6; padding: 6px 12px; text-decoration: none; border-radius: 5px; background-color: #f8f9fa; transition: color 0.3s, background-color 0.3s;"
                                                                   th:href="@{/asura/admin/comic/content/{slug}(slug=${comic.slug}, page=${chapterPage.number + 1}, size=${chapterPage.size})}"
                                                                   th:style="${chapterPage.isLast()} ? 'color: #6c757d; background-color: #e9ecef; cursor: not-allowed;' : 'color: #28a745;'"
                                                                   onmouseover="this.style.backgroundColor='#e9ecef'; this.style.color='#218838';"
                                                                   onmouseout="this.style.backgroundColor='#f8f9fa'; this.style.color='#28a745';">»</a>
                                                            </li>
                                                        </ul>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                                        <a th:href="@{/asura/admin/comic/content/{slug}(slug=${comic.slug})}" class="btn btn-default">Hủy</a>
                                        <button type="button" class="btn btn-danger" onclick="deleteComic()">Xóa truyện</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Image Selection Modal -->
        <div class="modal fade" id="modal-xl" aria-hidden="true">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Chọn hình bìa</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <input type="file" id="imageUpload" accept="image/*" />
                        <div id="imagePreview" class="mt-3"></div>
                    </div>
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                        <button type="button" class="btn btn-primary" onclick="saveImage()">Lưu</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/css/admin-assets/plugins/jquery/jquery.min.js"></script>
    <script src="/css/admin-assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/css/admin-assets/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <script src="/css/admin-assets/dist/js/adminlte.js"></script>
    <script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>
    <script src="https://cdn.jsdelivr.net/highlight.js/latest/highlight.min.js"></script>
    <script src="/css/admin-assets/plugins/select2/js/select2.full.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.select2').select2();

            new EasyMDE({
                element: document.getElementById('description'),
                spellChecker: false,
                maxHeight: '300px',
                renderingConfig: { codeSyntaxHighlighting: true }
            });
        });
    </script>

    <script>
        setTimeout(() => {
            $('.alert').fadeOut('slow');
        }, 3000);
    </script>


</body>
</html>